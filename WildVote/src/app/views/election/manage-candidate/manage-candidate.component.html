<c-row>
    <c-col xs>
      <c-card class="mb-4">
        <c-card-header class="bg-dark text-white">Election Candidates</c-card-header>
        <c-card-body>
          <table
            [hover]="true"
            [responsive]="true"
            [striped]="true"
            align="middle"
            cTable
            class="mb-0 border"
          >
            <thead cTableColor="dark">
              <tr>
                <th class="text-center">
                  Profile
                </th>
                <th>Student</th>
                <th>Position</th>
                <th>PartyList</th>
                <th>Manage</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let candidate of candidates; index as i">
                <td class="text-center">
                  <c-avatar
                    size="md"
                    src="{{ candidate.Profile }}"
                    status= "success"
                  ></c-avatar>
                </td>
                <td>
                  <div>{{ candidate.Fullname }}</div>
                  <div class="small text-medium-emphasis text-nowrap">
                    <span>
                      {{ candidate.Department }} - {{ candidate.Year }}
                    </span>
                  </div>
                </td>
                <td>
                    {{ candidate.Position }}
                </td>
                <td>
                  <div class="d-flex justify-content-between">
                    <div class="float-start">
                      <strong>{{ candidate.PartyList }}</strong>
                    </div>
                  </div>
                </td>
                <td>
                  <button  style="margin-right: 5px;" cButton color="info" [disabled]="(isElectionStart$ | async)" [routerLink]="['edit/', candidate.id]">Edit</button> 
                  <button cButton color="danger" (click)="removeCandidate(candidate.id)" [disabled]="(isElectionStart$ | async)" cButton>Remove</button>
                </td>
              </tr>
            </tbody>
          </table>
        </c-card-body>
      </c-card>
    </c-col>
</c-row>

<div class="d-grid gap-1 col-3 mx-auto p-3" *ngIf="(isElectionStart$ | async) === false">
  <button cButton color="primary" (click)="startElection()" variant="outline">Start Election</button>
</div>

<div class="d-grid gap-1 col-3 mx-auto p-3" *ngIf="(isElectionStart$ | async) === true">
  <button cButton color="danger" (click)="endElection()" variant="outline">End Election</button>
</div>

<div *ngIf="(highestVoteCounts$ | async) as highestVoteCounts">
  <!-- Check if highestVoteCounts is truthy before displaying the heading -->
  <ng-container *ngIf="highestVoteCounts.length > 0">
    <h2>Highest Vote Counts for Each Position</h2>
    <ul>
      <li *ngFor="let item of highestVoteCounts">
        Position: {{ item.position }} - Highest Vote Count: {{ item.Votes }} (Candidate: {{ item.Fullname }})
      </li>
    </ul>
  </ng-container>
</div>


<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header class="bg-dark text-white">President</c-card-header>
      <c-card-body>
        <form [formGroup]="PresidentVote">      
          <c-row class="justify-content-center text-center">
            <c-col *ngFor="let widget of candidateElectionPresident; let i = index" sm="4" xl="4">
              <c-widget-stat-d
                [color]="widget.color"
                [style]="widget.capBg"
                [values]="widget.values"
                class="mb-4"
              >
                <img [src]="widget.imageUrl" alt="Brand Image" height="150" class="my-4 text-white">

              </c-widget-stat-d>
              <input
                class="btn-check"
                formControlName="PresidentVoteID"
                type="radio"
                [value]="widget.id"
              />
              <label
                (click)="setPresidentVoteValue(widget.id)"
                cButton
                cFormCheckLabel
                variant="outline"
              >
                Vote <!-- Display Fullname as label text -->
              </label>
            </c-col>
          </c-row>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header class="bg-dark text-white">Vice-President</c-card-header>
      <c-card-body>
        <form [formGroup]="VicePresidentVote">      
          <c-row class="justify-content-center text-center">
            <c-col *ngFor="let widget of candidateElectionVicePresident; let i = index" sm="4" xl="4">
              <c-widget-stat-d
                [color]="widget.color"
                [style]="widget.capBg"
                [values]="widget.values"
                class="mb-4"
              >
                <img [src]="widget.imageUrl" alt="Brand Image" height="150" class="my-4 text-white">

              </c-widget-stat-d>
              <input
                class="btn-check"
                formControlName="VicePresidentVoteID"
                type="radio"
                [value]="widget.id"
              />
              <label
                (click)="setVicePresidentVoteValue(widget.id)"
                cButton
                cFormCheckLabel
                variant="outline"
              >
                Vote <!-- Display Fullname as label text -->
              </label>
            </c-col>
          </c-row>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header class="bg-dark text-white">Secretary</c-card-header>
      <c-card-body>
        <form [formGroup]="SecretaryVote">      
          <c-row class="justify-content-center text-center">
            <c-col *ngFor="let widget of candidateElectionSecretary; let i = index" sm="4" xl="4">
              <c-widget-stat-d
                [color]="widget.color"
                [style]="widget.capBg"
                [values]="widget.values"
                class="mb-4"
              >
                <img [src]="widget.imageUrl" alt="Brand Image" height="150" class="my-4 text-white">

              </c-widget-stat-d>
              <input
                class="btn-check"
                formControlName="SecretaryVoteID"
                type="radio"
                [value]="widget.id"
              />
              <label
                (click)="setSecretaryVoteValue(widget.id)"
                cButton
                cFormCheckLabel
                variant="outline"
              >
                Vote <!-- Display Fullname as label text -->
              </label>
            </c-col>
          </c-row>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header class="bg-dark text-white">Treasurer</c-card-header>
      <c-card-body>
        <form [formGroup]="TreasurerVote">      
          <c-row class="justify-content-center text-center">
            <c-col *ngFor="let widget of candidateElectionTreasurer; let i = index" sm="4" xl="4">
              <c-widget-stat-d
                [color]="widget.color"
                [style]="widget.capBg"
                [values]="widget.values"
                class="mb-4"
              >
                <img [src]="widget.imageUrl" alt="Brand Image" height="150" class="my-4 text-white">

              </c-widget-stat-d>
              <input
                class="btn-check"
                formControlName="TreasurerVoteID"
                type="radio"
                [value]="widget.id"
              />
              <label
                (click)="setTreasurerVoteValue(widget.id)"
                cButton
                cFormCheckLabel
                variant="outline"
              >
                Vote <!-- Display Fullname as label text -->
              </label>
            </c-col>
          </c-row>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header class="bg-dark text-white">Auditor</c-card-header>
      <c-card-body>
        <form [formGroup]="AuditorVote">      
          <c-row class="justify-content-center text-center">
            <c-col *ngFor="let widget of candidateElectionAuditor; let i = index" sm="4" xl="4">
              <c-widget-stat-d
                [color]="widget.color"
                [style]="widget.capBg"
                [values]="widget.values"
                class="mb-4"
              >
                <img [src]="widget.imageUrl" alt="Brand Image" height="150" class="my-4 text-white">

              </c-widget-stat-d>
              <input
                class="btn-check"
                formControlName="AuditorVoteID"
                type="radio"
                [value]="widget.id"
              />
              <label
                (click)="setAuditorVoteValue(widget.id)"
                cButton
                cFormCheckLabel
                variant="outline"
              >
                Vote <!-- Display Fullname as label text -->
              </label>
            </c-col>
          </c-row>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-row>
  <c-col xs>
    <c-card class="mb-4">
      <c-card-header class="bg-dark text-white">CPE Representative</c-card-header>
      <c-card-body>
        <form [formGroup]="CPERepresentativeVote">      
          <c-row class="justify-content-center text-center">
            <c-col *ngFor="let widget of candidateElectionCPERepresentative; let i = index" sm="4" xl="4">
              <c-widget-stat-d
                [color]="widget.color"
                [style]="widget.capBg"
                [values]="widget.values"
                class="mb-4"
              >
                <img [src]="widget.imageUrl" alt="Brand Image" height="150" class="my-4 text-white">

              </c-widget-stat-d>
              <input
                class="btn-check"
                formControlName="CPERepresentative"
                type="radio"
                [value]="widget.id"
              />
              <label
                (click)="setCPERepresentativeVoteValue(widget.id)"
                cButton
                cFormCheckLabel
                variant="outline"
              >
                Vote <!-- Display Fullname as label text -->
              </label>
            </c-col>
          </c-row>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

